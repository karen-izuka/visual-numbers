<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>doodles | visual numbers</title>
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/atom-one-dark.min.css">
  <link rel="stylesheet" href="../../style.css">
  <link rel="stylesheet" href="../style.css">
</head>
<body>
  <header>
    <div class="page-header-title">VISUAL NUMBERS</div>
    <div>
      <ul class="list-nav">
        <li>
          <a href="/diary/">back to diary</a>
        </li>
        <li>
          <a href="/diary/entry-01/">next entry</a>
        </li>
      </ul>
    </div>
  </header>
  <div class="container">
    <h2>A Different Way to Write SQL Queries</h2>
    <div class="code">
      <pre><code class="sql">
      with a as (select date_key, product_key, customer_key, sum(units_sold) units_sold
      from fact_table
      group by date_key, product_key, customer_key),

      b as (select date_key, fiscal_year
      from date_table
      group by date_key, fiscal_year),

      c as (select product_key, sku
      from product_table
      group by product_key, sku)
      
      select b.fiscal_year, c.sku, sum(a.units_sold) units_sold
      from a
      left outer join b on (a.date_key = b.date_key)
      left outer join c on (a.product_key = c.product_key)
      where b.fiscal_year = 2020 and c.sku = 'ABCDE'
      group by b.fiscal_year, c.sku;
      </code></pre>
    </div>
    <div>
      <p>SQL Notes</p>
    </div>
  </div>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
</body>
</html>